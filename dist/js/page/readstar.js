define(["jquery","base64","template"],function(a,t,c){var n,e,o,s=window.localStorage;function i(s){a.ajax({url:"/book/list",dataType:"json",data:{articl:s},success:function(t){var n,e,o=t.jsonp;n=o,(e=document.createElement("script")).src=n,window.duokan_fiction_chapter=function(t){var n=a.base64().decode(t);a(".readmain").empty(),c(a(".textp").html(),JSON.parse(n),a(".readmain"))},document.head.appendChild(e),a(".page").html(s)}})}i(1),a(".dh").on("click",".bot>.b-b>span:nth-child(3)",function(){a(".readmain").toggleClass("day")}),a(".readmain").on("click",function(){a(".dh").toggleClass("active")}),a(".dh").on("click",function(){a(".dh").toggleClass("active"),console.log(2)}),a(".ups").on("click",function(){return e=a(".page").html(),console.log(e),e--,console.log(e),i(e),s.setItem("pages",e),!1}),a(".upx").on("click",function(){return e=a(".page").html(),console.log(e),e++,console.log(e),i(e),s.setItem("pages",e),!1}),a(".dh").on("click",".bot>.b-b>span:nth-child(1)",function(){return a(".dh .bot .font").toggleClass("active"),!1}),a(".readmain").css("background",s.getItem("bgs")),a(".font .bg span").on("click",function(){var t=a(this).css("background");a(".readmain").css("background",t),s.setItem("bgs",t)}),a(".readmain").css("font-size",s.getItem("fontsize")+"px"),a(".font .size .big").on("click",function(t){t.stopPropagation(),o=parseInt(a(".readmain").css("font-size")),a(".readmain").css("font-size",o+2),s.setItem("fontsize",o)}),a(".font .size .small").on("click",function(t){t.stopPropagation(),o=parseInt(a(".readmain").css("font-size")),a(".readmain").css("font-size",o-2),s.setItem("fontsize",o)}),a.ajax({url:"/book/chap",async:!1,dataType:"json",success:function(t){console.log(t),c(a(".listchap").html(),t.item,".lists>ul"),a(".bot .b-t span:nth-child(2)").html('<b class="page">'+n+"</b>/"+t.item.toc.length)}}),a(".dh").on("click",".bot>.b-b>span:nth-child(2)",function(){return a(".wrap .lists").toggleClass("active"),a(".lists>ul").on("click","li",function(){n=a(this).attr("data-id"),a(".wrap .lists").removeClass("active"),a(".readmain").empty(),i(n)}),!1})});